<?xml version="1.0" encoding="utf-8"?>
<ManagementPack SchemaVersion="2.0" ContentReadable="true" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Manifest>
    <Identity>
      <ID>Windows.Server.Webservice.BasicWatcher</ID>
      <Version>1.0.0.247</Version>
    </Identity>
    <Name>Windows.Server.Webservice.BasicWatcher [Apache, Tomcat, IIS]</Name>
    <References>
      <Reference Alias="MSDL">
        <ID>Microsoft.SystemCenter.DataWarehouse.Library</ID>
        <Version>7.1.10226.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="SC">
        <ID>Microsoft.SystemCenter.Library</ID>
        <Version>7.0.8433.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="Windows">
        <ID>Microsoft.Windows.Library</ID>
        <Version>7.5.8501.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="Health">
        <ID>System.Health.Library</ID>
        <Version>7.0.8433.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="System">
        <ID>System.Library</ID>
        <Version>7.5.8501.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="Perf">
        <ID>System.Performance.Library</ID>
        <Version>7.0.8433.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
    </References>
  </Manifest>
  <TypeDefinitions>
    <EntityTypes>
      <ClassTypes>
        <ClassType ID="Windows.Server.Webservice.BasicWatcher.Computer" Base="Windows!Microsoft.Windows.ComputerRole" Accessibility="Public" Abstract="true" Hosted="true" Singleton="false">
          <Property ID="ComputerName" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="WindowsVersion" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="Description" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="IP" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="OU" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
        </ClassType>
        <ClassType ID="Windows.Server.Webservice.BasicWatcher.Computer.IIS" Base="Windows.Server.Webservice.BasicWatcher.Computer" Accessibility="Public" Abstract="false" Hosted="true" Singleton="false" />
        <ClassType ID="Windows.Server.Webservice.BasicWatcher.Computer.Apache" Base="Windows.Server.Webservice.BasicWatcher.Computer" Accessibility="Public" Abstract="false" Hosted="true" Singleton="false" />
        <ClassType ID="Windows.Server.Webservice.BasicWatcher.Computer.ApacheTomcat" Base="Windows.Server.Webservice.BasicWatcher.Computer" Accessibility="Public" Abstract="false" Hosted="true" Singleton="false" />
        <ClassType ID="Windows.Server.Webservice.BasicWatcher.Computer.FTP.IIS" Base="Windows.Server.Webservice.BasicWatcher.Computer" Accessibility="Public" Abstract="false" Hosted="true" Singleton="false" />
        <ClassType ID="Windows.Server.Webservice.BasicWatcher.Computer.FTP.ServU" Base="Windows.Server.Webservice.BasicWatcher.Computer" Accessibility="Public" Abstract="false" Hosted="true" Singleton="false" />
      </ClassTypes>
    </EntityTypes>
    <ModuleTypes>
      <DataSourceModuleType ID="BasicWatcher.WebService.DataSource.KPIs.Cookdown" Accessibility="Internal" Batching="false">
        <Configuration>
          <xsd:element minOccurs="1" name="IntervalSeconds" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element name="MonitorItem" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <DataSource ID="Scheduler" TypeID="System!System.SimpleScheduler">
                <IntervalSeconds>$Config/IntervalSeconds$</IntervalSeconds>
                <SyncTime />
              </DataSource>
              <ProbeAction ID="Script" TypeID="Windows!Microsoft.Windows.PowerShellPropertyBagProbe">
                <ScriptName>BasicWatcher.Collect.KPIs.ps1</ScriptName>
                <ScriptBody><![CDATA[param($MonitorItem)
 $api = New-Object -comObject 'MOM.ScriptAPI'

$computerName        = $env:COMPUTERNAME
$testedAt            = "Tested on: $(Get-Date -Format u) / $(([TimeZoneInfo]::Local).DisplayName)"
$WindowsVersion      = Get-WmiObject -Class Win32_OperatingSystem | Select-Object -ExpandProperty Caption

try {
	$computerDescription = Get-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\services\LanmanServer\Parameters | Select-Object -ExpandProperty srvcomment
} catch {
	$computerDescription = [string]::Empty
}

$localComputerDomain = ([System.DirectoryServices.ActiveDirectory.Domain]::GetComputerDomain()).Name
$computerName        = $computerName + '.' + $localComputerDomain

if (([string]::IsNullOrEmpty($computerDescription))) {
	$computerDescription = 'Not-Maintained'
} else {
	$noActionRequiredSo  = 'Keep description'
}


#$api.LogScriptEvent('BasicWatcher.Collect.KPIs.ps1',250,4,"On computer $($computerName) with searching for $($MonitorItem)")	

if ($MonitorItem -eq 'svchost') {
	
#	$api.LogScriptEvent('BasicWatcher.Collect.KPIs.ps1',251,2,"On computer $($computerName) with searching for $($MonitorItem) - SVCHOST ")	

	$allSvcHostProc = Get-Process | Where-Object {$_.Name -eq $MonitorItem}

	$allSvcHostProc | ForEach-Object {	
		if ($_ | Select-Object -ExpandProperty Modules | Where-Object {$_.ModuleName -contains 'ftpsvc.dll'}){
				$ftpPid = $($_ |Select-Object -ExpandProperty Id)
		}
	}

	$allPerfCounter = Get-Counter "\Process($MonitorItem*)\*"  | Select-Object -ExpandProperty CounterSamples
	$perfCounterTmp = $allPerfCounter | Where-Object {$_.Path -match 'id Proces'} | Where-Object {$_.CookedValue -eq $ftpPid}
	$perfCounterTmp = $perfCounterTmp | Select-Object -ExpandProperty Path
	$svcPattern     = [regex]::Match($perfCounterTmp,'\(svchost#?\d*\)') | Select-Object -ExpandProperty Value
	$allPerfCounter = $allPerfCounter | Where-Object {$_.Path -match $svcPattern}
	
} else {

	$allPerfCounter  = Get-Counter "\Process($MonitorItem*)\*" | Select-Object -ExpandProperty CounterSamples
	 
}
 
$perfCounterReg  = '% processor time|working set \- private|io data bytes\/sec|handle count'
$perfCounterList = New-Object -TypeName 'System.Collections.ArrayList'

#$api.LogScriptEvent('BasicWatcher.Collect.KPIs.ps1',252,2,"On computer for $($MonitorItem) found No Counter: $($allPerCounter.count)")	

$allPerfCounter | ForEach-Object {
    if ($_.Path -match $perfCounterReg) {
        
		$newPath                = $_.Path -replace '(\\\\[\w]*\\process[()\w#]*\\)',''        
		[double]$newCookedValue = 1

		if($newPath -match '% processor time') {
			$newCookedValue = [Math]::Round($_.CookedValue)		
			$newPath        = 'PercentProcessorTime'
		} elseif ($newPath -match 'working set \- private') {
			$newPath = 'WorkingSetPrivateMB'			            
			if ($_.CookedValue) {
				$newCookedValue = [Math]::Round($_.CookedValue / 1MB) 				
			} else {
				$newCookedValue = 1
			}						
		} elseif ($newPath -match 'io data bytes\/sec') {
			$newPath = 'IODataMBPerSec'
			if ($_.CookedValue) {
				$newCookedValue = [Math]::Round($_.CookedValue / 1MB) 				
			} else {
				$newCookedValue = 1
			}
		} elseif ($newPath -match 'handle count') {
			$newPath = 'HandleCount'
			if ($_.CookedValue) {
				$newCookedValue = $_.CookedValue				
			} else {
				$newCookedValue = 1
			}			
		}
        		
		if ($newCookedValue -eq $null) {
			$newCookedValue = 1			
		} 		

		$newCookedValue = [double]::Parse($newCookedValue)

		$perfHash = @{'Location' = $newPath}
		$perfHash.Add('CookedValue',$newCookedValue)
		$perfObj  = New-Object -TypeName PSObject -Property $perfHash        
		$null     = $perfCounterList.Add($perfObj)
    }
}

$perfCounterSum = New-Object -TypeName 'System.Collections.ArrayList'

$perfCounterList | Group-Object -Property Location | ForEach-Object {
    $perfSumHash = @{'Location' = ($_.Name)}
    $perfSumHash.Add('CookedValue', (($_.Group | Measure-Object -Property CookedValue -Sum).Sum))
    $perfSumObj = New-Object -TypeName PSObject -Property $perfSumHash
    $null       = $perfCounterSum.Add($perfSumObj)
}

$perfCounterSum | ForEach-Object {

	$sumi  = "ComputerName>$($ComputerName)< testedAt>$($testedAt)< WindowsVersion>$($WindowsVersion)< ComputerDescription>$($computerDescription)<"
	$sumi += "Location>$($_.Location)< CookedValue>$($_.CookedValue)< TypeOfCookedValue $($_.CookedValue.GetType())"
	
	if (($_.Location -ne $null -and ($_.Location.Gettype().Name -eq 'String' )) -and (($_.CookedValue -ne $null) -and ($_.CookedValue -match '\d'))) {		
	#	$api.LogScriptEvent('BasicWatcher.Collect.KPIs.ps1',253,2,"On computer $($computerName) sending Bag with searching for $($MonitorItem)`n Bag: $($sumi)")	
		$foo = 'bar'
	} else {
		$api.LogScriptEvent('BasicWatcher.Collect.KPIs.ps1',253,1,"On computer $($computerName) NOT SENDING Bag with searching for $($MonitorItem)`n Bag: $($sumi)")	
		continue 
	}	
			                  
	$objekt = $MonitorItem + '.' + 'Info'

	$bag = $api.CreatePropertybag()						                  
	$bag.AddValue("testedAt",$testedAt)	
	$bag.AddValue("WindowsVersion",$WindowsVersion)		               
	$bag.AddValue("ComputerDescription",$computerDescription)	
	$bag.AddValue('Counter',$_.Location)
	$bag.AddValue('Value',$_.CookedValue)
	$bag.AddValue('Instance',$ComputerName)
	$bag.AddValue('Objekt',$objekt)
	$bag

}]]></ScriptBody>
                <Parameters>
                  <Parameter>
                    <Name>MonitorItem</Name>
                    <Value>$Config/MonitorItem$</Value>
                  </Parameter>
                </Parameters>
                <TimeoutSeconds>300</TimeoutSeconds>
              </ProbeAction>
            </MemberModules>
            <Composition>
              <Node ID="Script">
                <Node ID="Scheduler" />
              </Node>
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>System!System.PropertyBagData</OutputType>
      </DataSourceModuleType>
      <DataSourceModuleType ID="BasicWatcher.WebService.DataSource.IPConnections.Cookdown" Accessibility="Internal" Batching="false">
        <Configuration>
          <xsd:element minOccurs="1" name="IntervalSeconds" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element name="MonitorItem" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <DataSource ID="Scheduler" TypeID="System!System.SimpleScheduler">
                <IntervalSeconds>$Config/IntervalSeconds$</IntervalSeconds>
                <SyncTime />
              </DataSource>
              <ProbeAction ID="Script" TypeID="Windows!Microsoft.Windows.PowerShellPropertyBagProbe">
                <ScriptName>BasicWatcher.Collect.IPConnections.ps1</ScriptName>
                <ScriptBody><![CDATA[param($MonitorItem)

$api = New-Object -comObject 'MOM.ScriptAPI'

$computerName   = $env:COMPUTERNAME
$testedAt       = "Tested on: $(Get-Date -Format u) / $(([TimeZoneInfo]::Local).DisplayName)"
$WindowsVersion = Get-WmiObject -Class Win32_OperatingSystem | Select-Object -ExpandProperty Caption
$regIPPat       = '\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}'

try {
	$computerDescription = Get-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\services\LanmanServer\Parameters | Select-Object -ExpandProperty srvcomment
} catch {
	$computerDescription = [string]::Empty
}

$localComputerDomain = ([System.DirectoryServices.ActiveDirectory.Domain]::GetComputerDomain()).Name
$computerName        = $computerName + '.' + $localComputerDomain

if (([string]::IsNullOrEmpty($computerDescription))) {
	$computerDescription = 'Not-Maintained'
} else {
	$noActionRequiredSo  = 'Keep description'
}

$netStatIpFile = [System.IO.Path]::GetTempFileName()

#$api.LogScriptEvent('BasicWatcher.Collect.IPConnections.ps1',350,4,"On computer $($computerName) with searching for $($MonitorItem)")	

Function Format-NetstatData {

	param(
		[object]$netstatInPut,		
		[ref]$nestatIPData
	)

	$allProcesses    = Get-Process | Select-Object -Property Name, Path, StartTime, id
	$netStatConnects = New-Object -TypeName System.Collections.Generic.List[object]
	$netStatArr      =  $netstatInPut -split "`r`n"

	$localComputerName   = $env:COMPUTERNAME
	$localComputerDomain = ([System.DirectoryServices.ActiveDirectory.Domain]::GetComputerDomain()).Name
	$localIPAddresses    = ([System.Net.Dns]::GetHostAddresses($localComputerName)) | Where-Object {$_.AddressFamily -eq 'interNetwork'} | Select-Object -ExpandProperty IPAddressToString

	$netStatArr | ForEach-Object {

		$netStatItm = $_

		if ($netStatItm -match "\d") {       

			$netStatItmParts = [Regex]::Split($netStatItm,"\s{2,}")
			$proto        = $netStatItmParts[1]
			$localIP      = ($netStatItmParts[2] -split ':')[0]
			$localPort    = ($netStatItmParts[2] -split ':')[1]
			$remoteIP     = ($netStatItmParts[3] -split ':')[0]
			$remotePort   = ($netStatItmParts[3] -split ':')[1]
			$connectState = $netStatItmParts[4]
			$procId       = $netStatItmParts[5]

			$procInfo      = $allProcesses | Where-Object { $_.id -eq $procId }
			$procName      = $procInfo.Name
			$procPath      = $procInfo.Path
			$procStartTime = $procInfo.StartTime

			if(-not $procPath) {
				$procPath = 'Path not exposed to API'    
			}		

			if ($localIPAddresses -contains $localIP) {
				$localName = $localComputerName
			}			

			if (($localIp -match $regIpPat -and $remoteIp -match $regIpPat) -and ($remoteIP -notmatch '0.0.0.0|127.0.0.1') ) {
				$myNetHsh = @{'proto' = $proto}
				$myNetHsh.Add('localIP', $localIP)
				$myNetHsh.Add('localName', $localName)
				$myNetHsh.Add('localPort', $localPort)
				$myNetHsh.Add('remoteIP', $remoteIP)
				$myNetHsh.Add('remotePort', $remotePort)
				$myNetHsh.Add('connectState', $connectState)
				$myNetHsh.Add('procId', $procId)
				$myNetHsh.Add('procName', $procName)
				$myNetHsh.Add('procPath', $procPath)
				$myNetHsh.Add('procStartTime', $procStartTime)

				$myNetObj = New-Object -TypeName PSObject -Property $myNetHsh
				$null     = $netStatConnects.Add($myNetObj)    
			}

		}#END if ($netStatItm -match "\d") 

	} #END $netStatIpArr | ForEach-Object {} 

	If ($netStatConnects.count -gt 0) {
		$rtn = $true
		$nestatIPData.Value = $netStatConnects
	} else {
		$rtn = $false	
	}

	$rtn

} #END Funciton Get-NetstatIPData



Invoke-Expression "C:\Windows\System32\netstat.exe -ano" | Out-File -FilePath $netStatIpFile
$netStatIp = Get-Content -Path $netStatIpFile | Out-String


$netStatIPConnects = New-Object -TypeName System.Collections.Generic.List[object]
Format-NetstatData -netstatInPut $netStatIp -nestatIPData ([ref]$netStatIPConnects)

$ipConnections = ''
$ipConnections = $netStatIPConnects | Where-Object {$_.procPath -match "(?i)[\\]$MonitorItem" -or $_.procName  -match "(?i)$MonitorItem"}

if ($ipConnections -ne '') {	
	#$api.LogScriptEvent('BasicWatcher.Collect.IPConnections.ps1',351,4,"Searching for $($MonitorItem) found no: $($ipConnections.Count) IPConnections")	
	$foo = 'bar'
} else {
	$api.LogScriptEvent('BasicWatcher.Collect.IPConnections.ps1',351,1,"Searching for $($MonitorItem) found no IPConnections. Ending now.")	
	Exit
}


$ipConnectionsCount = $ipConnections | Group-Object -Property remoteIP | Measure-Object  | Select-Object -ExpandProperty Count

#$api.LogScriptEvent('BasicWatcher.Collect.IPConnections.ps1',352,4,"Searching for $($MonitorItem) found individual no $($ipConnectionsCount) IPConnections")	

$objekt = $MonitorItem + '.' + 'Info'

$bag = $api.CreatePropertybag()						                  
$bag.AddValue("testedAt",$testedAt)	
$bag.AddValue("WindowsVersion",$WindowsVersion)		               
$bag.AddValue("ComputerDescription",$computerDescription)	
$bag.AddValue('Counter','ipConnections')
$bag.AddValue('Value',$ipConnectionsCount)
$bag.AddValue('Instance',$ComputerName)
$bag.AddValue('Objekt',$objekt)
$bag]]></ScriptBody>
                <Parameters>
                  <Parameter>
                    <Name>MonitorItem</Name>
                    <Value>$Config/MonitorItem$</Value>
                  </Parameter>
                </Parameters>
                <TimeoutSeconds>300</TimeoutSeconds>
              </ProbeAction>
            </MemberModules>
            <Composition>
              <Node ID="Script">
                <Node ID="Scheduler" />
              </Node>
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>System!System.PropertyBagData</OutputType>
      </DataSourceModuleType>
      <ConditionDetectionModuleType ID="Basic.WebService.SpecificCounterPerfFilterMapper" Accessibility="Public" Batching="false" Stateful="false" PassThrough="false">
        <Configuration>
          <IncludeSchemaTypes>
            <SchemaType>System!System.ExpressionEvaluatorSchema</SchemaType>
          </IncludeSchemaTypes>
          <xsd:element name="InterestingCounter" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element name="ObjectName" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element name="CounterName" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element name="InstanceName" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element name="Value" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <ConditionDetection ID="FilterPerfForEachType" TypeID="System!System.ExpressionFilter">
                <Expression>
                  <And>
                    <Expression>
                      <SimpleExpression>
                        <ValueExpression>
                          <XPathQuery Type="String">Property[@Name='Instance']</XPathQuery>
                        </ValueExpression>
                        <Operator>Equal</Operator>
                        <ValueExpression>
                          <Value Type="String">$Target/Property[Type='Windows.Server.Webservice.BasicWatcher.Computer']/ComputerName$</Value>
                        </ValueExpression>
                      </SimpleExpression>
                    </Expression>
                    <!-- Pulls the perf related to the interesting counter. -->
                    <Expression>
                      <SimpleExpression>
                        <ValueExpression>
                          <XPathQuery Type="String">Property[@Name='Counter']</XPathQuery>
                        </ValueExpression>
                        <Operator>Equal</Operator>
                        <ValueExpression>
                          <Value Type="String">$Config/InterestingCounter$</Value>
                        </ValueExpression>
                      </SimpleExpression>
                    </Expression>
                  </And>
                </Expression>
              </ConditionDetection>
              <ConditionDetection ID="PerfMapper" TypeID="Perf!System.Performance.DataGenericMapper">
                <ObjectName>$Config/ObjectName$</ObjectName>
                <CounterName>$Config/CounterName$</CounterName>
                <InstanceName>$Config/InstanceName$</InstanceName>
                <Value>$Config/Value$</Value>
              </ConditionDetection>
            </MemberModules>
            <Composition>
              <Node ID="PerfMapper">
                <Node ID="FilterPerfForEachType" />
              </Node>
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>Perf!System.Performance.Data</OutputType>
        <InputTypes>
          <InputType>System!System.BaseData</InputType>
        </InputTypes>
      </ConditionDetectionModuleType>
    </ModuleTypes>
  </TypeDefinitions>
  <Monitoring>
    <Discoveries>
      <Discovery ID="Windows.Server.Webservice.BasicWatcher.Discovery.Windows.Server.Webservice.Computer.FTP.ServU" Target="Windows!Microsoft.Windows.Computer" Enabled="false" ConfirmDelivery="false" Remotable="true" Priority="Normal">
        <Category>Discovery</Category>
        <DiscoveryTypes>
          <DiscoveryClass TypeID="Windows.Server.Webservice.BasicWatcher.Computer.FTP.ServU" />
        </DiscoveryTypes>
        <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.FilteredRegistryDiscoveryProvider">
          <ComputerName>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
          <RegistryAttributeDefinitions>
            <RegistryAttributeDefinition>
              <AttributeName>KeyExists</AttributeName>
              <Path>System\CurrentControlSet\Services\Serv-U</Path>
              <PathType>0</PathType>
              <AttributeType>0</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>WindowsVersion</AttributeName>
              <Path>SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProductName</Path>
              <PathType>1</PathType>
              <AttributeType>1</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>Description</AttributeName>
              <Path>SYSTEM\CurrentControlSet\services\LanmanServer\Parameters\srvcomment</Path>
              <PathType>1</PathType>
              <AttributeType>1</AttributeType>
            </RegistryAttributeDefinition>
          </RegistryAttributeDefinitions>
          <Frequency>86400</Frequency>
          <ClassId>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer.FTP.ServU"]$</ClassId>
          <InstanceSettings>
            <Settings>
              <Setting>
                <Name>$MPElement[Name="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="System!System.Entity"]/DisplayName$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/ComputerName$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/WindowsVersion$</Name>
                <Value>$Data/Values/WindowsVersion$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/Description$</Name>
                <Value>$Data/Values/Description$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/IP$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/IPAddress$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/OU$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/OrganizationalUnit$</Value>
              </Setting>
            </Settings>
          </InstanceSettings>
          <Expression>
            <SimpleExpression>
              <ValueExpression>
                <XPathQuery>Values/KeyExists</XPathQuery>
              </ValueExpression>
              <Operator>Equal</Operator>
              <ValueExpression>
                <Value>true</Value>
              </ValueExpression>
            </SimpleExpression>
          </Expression>
        </DataSource>
      </Discovery>
      <Discovery ID="Windows.Server.Webservice.BasicWatcher.Discovery.Windows.Server.Webservice.Computer.ApacheTomcat" Target="Windows!Microsoft.Windows.Computer" Enabled="true" ConfirmDelivery="false" Remotable="true" Priority="Normal">
        <Category>Discovery</Category>
        <DiscoveryTypes>
          <DiscoveryClass TypeID="Windows.Server.Webservice.BasicWatcher.Computer.ApacheTomcat" />
        </DiscoveryTypes>
        <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.FilteredRegistryDiscoveryProvider">
          <ComputerName>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
          <RegistryAttributeDefinitions>
            <RegistryAttributeDefinition>
              <AttributeName>KeyExists6</AttributeName>
              <Path>SYSTEM\CurrentControlSet\services\Tomcat6</Path>
              <PathType>0</PathType>
              <AttributeType>0</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>KeyExists7</AttributeName>
              <Path>SYSTEM\CurrentControlSet\services\Tomcat7</Path>
              <PathType>0</PathType>
              <AttributeType>0</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>KeyExists8</AttributeName>
              <Path>SYSTEM\CurrentControlSet\services\Tomcat8</Path>
              <PathType>0</PathType>
              <AttributeType>0</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>KeyExists9</AttributeName>
              <Path>SYSTEM\CurrentControlSet\services\Tomcat9</Path>
              <PathType>0</PathType>
              <AttributeType>0</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>WindowsVersion</AttributeName>
              <Path>SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProductName</Path>
              <PathType>1</PathType>
              <AttributeType>1</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>Description</AttributeName>
              <Path>SYSTEM\CurrentControlSet\services\LanmanServer\Parameters\srvcomment</Path>
              <PathType>1</PathType>
              <AttributeType>1</AttributeType>
            </RegistryAttributeDefinition>
          </RegistryAttributeDefinitions>
          <Frequency>86400</Frequency>
          <ClassId>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer.ApacheTomcat"]$</ClassId>
          <InstanceSettings>
            <Settings>
              <Setting>
                <Name>$MPElement[Name="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="System!System.Entity"]/DisplayName$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/ComputerName$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/WindowsVersion$</Name>
                <Value>$Data/Values/WindowsVersion$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/Description$</Name>
                <Value>$Data/Values/Description$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/IP$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/IPAddress$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/OU$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/OrganizationalUnit$</Value>
              </Setting>
            </Settings>
          </InstanceSettings>
          <Expression>
            <Or>
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <XPathQuery>Values/KeyExists6</XPathQuery>
                  </ValueExpression>
                  <Operator>Equal</Operator>
                  <ValueExpression>
                    <Value>true</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <XPathQuery>Values/KeyExists7</XPathQuery>
                  </ValueExpression>
                  <Operator>Equal</Operator>
                  <ValueExpression>
                    <Value>true</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <XPathQuery>Values/KeyExists8</XPathQuery>
                  </ValueExpression>
                  <Operator>Equal</Operator>
                  <ValueExpression>
                    <Value>true</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <XPathQuery>Values/KeyExists9</XPathQuery>
                  </ValueExpression>
                  <Operator>Equal</Operator>
                  <ValueExpression>
                    <Value>true</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
            </Or>
          </Expression>
        </DataSource>
      </Discovery>
      <Discovery ID="Windows.Server.Webservice.BasicWatcher.Discovery.Windows.Server.Webservice.Computer.Apache" Target="Windows!Microsoft.Windows.Computer" Enabled="true" ConfirmDelivery="false" Remotable="true" Priority="Normal">
        <Category>Discovery</Category>
        <DiscoveryTypes>
          <DiscoveryClass TypeID="Windows.Server.Webservice.BasicWatcher.Computer.Apache" />
        </DiscoveryTypes>
        <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.FilteredRegistryDiscoveryProvider">
          <ComputerName>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
          <RegistryAttributeDefinitions>
            <RegistryAttributeDefinition>
              <AttributeName>KeyExists24</AttributeName>
              <Path>SYSTEM\CurrentControlSet\services\Apache2.4</Path>
              <PathType>0</PathType>
              <AttributeType>0</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>KeyExists23</AttributeName>
              <Path>SYSTEM\CurrentControlSet\services\Apache2.3</Path>
              <PathType>0</PathType>
              <AttributeType>0</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>KeyExists22</AttributeName>
              <Path>SYSTEM\CurrentControlSet\services\Apache2.2</Path>
              <PathType>0</PathType>
              <AttributeType>0</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>KeyExists20</AttributeName>
              <Path>SYSTEM\CurrentControlSet\services\Apache2.0</Path>
              <PathType>0</PathType>
              <AttributeType>0</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>WindowsVersion</AttributeName>
              <Path>SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProductName</Path>
              <PathType>1</PathType>
              <AttributeType>1</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>Description</AttributeName>
              <Path>SYSTEM\CurrentControlSet\services\LanmanServer\Parameters\srvcomment</Path>
              <PathType>1</PathType>
              <AttributeType>1</AttributeType>
            </RegistryAttributeDefinition>
          </RegistryAttributeDefinitions>
          <Frequency>86400</Frequency>
          <ClassId>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer.Apache"]$</ClassId>
          <InstanceSettings>
            <Settings>
              <Setting>
                <Name>$MPElement[Name="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="System!System.Entity"]/DisplayName$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/ComputerName$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/WindowsVersion$</Name>
                <Value>$Data/Values/WindowsVersion$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/Description$</Name>
                <Value>$Data/Values/Description$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/IP$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/IPAddress$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/OU$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/OrganizationalUnit$</Value>
              </Setting>
            </Settings>
          </InstanceSettings>
          <Expression>
            <Or>
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <XPathQuery>Values/KeyExists24</XPathQuery>
                  </ValueExpression>
                  <Operator>Equal</Operator>
                  <ValueExpression>
                    <Value>true</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <XPathQuery>Values/KeyExists23</XPathQuery>
                  </ValueExpression>
                  <Operator>Equal</Operator>
                  <ValueExpression>
                    <Value>true</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <XPathQuery>Values/KeyExists22</XPathQuery>
                  </ValueExpression>
                  <Operator>Equal</Operator>
                  <ValueExpression>
                    <Value>true</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <XPathQuery>Values/KeyExists20</XPathQuery>
                  </ValueExpression>
                  <Operator>Equal</Operator>
                  <ValueExpression>
                    <Value>true</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
            </Or>
          </Expression>
        </DataSource>
      </Discovery>
      <Discovery ID="Windows.Server.Webservice.BasicWatcher.Discovery.Windows.Server.Webservice.Computer.IIS" Target="Windows!Microsoft.Windows.Computer" Enabled="false" ConfirmDelivery="false" Remotable="true" Priority="Normal">
        <Category>Discovery</Category>
        <DiscoveryTypes>
          <DiscoveryClass TypeID="Windows.Server.Webservice.BasicWatcher.Computer.IIS" />
        </DiscoveryTypes>
        <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.FilteredRegistryDiscoveryProvider">
          <ComputerName>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
          <RegistryAttributeDefinitions>
            <RegistryAttributeDefinition>
              <AttributeName>KeyExists</AttributeName>
              <Path>System\CurrentControlSet\Services\IISAdmin</Path>
              <PathType>0</PathType>
              <AttributeType>0</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>KeyExists2</AttributeName>
              <Path>SYSTEM\CurrentControlSet\Services\w3logsvc\Parameters</Path>
              <PathType>0</PathType>
              <AttributeType>0</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>WindowsVersion</AttributeName>
              <Path>SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProductName</Path>
              <PathType>1</PathType>
              <AttributeType>1</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>Description</AttributeName>
              <Path>SYSTEM\CurrentControlSet\services\LanmanServer\Parameters\srvcomment</Path>
              <PathType>1</PathType>
              <AttributeType>1</AttributeType>
            </RegistryAttributeDefinition>
          </RegistryAttributeDefinitions>
          <Frequency>86400</Frequency>
          <ClassId>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer.IIS"]$</ClassId>
          <InstanceSettings>
            <Settings>
              <Setting>
                <Name>$MPElement[Name="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="System!System.Entity"]/DisplayName$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/ComputerName$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/WindowsVersion$</Name>
                <Value>$Data/Values/WindowsVersion$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/Description$</Name>
                <Value>$Data/Values/Description$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/IP$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/IPAddress$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/OU$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/OrganizationalUnit$</Value>
              </Setting>
            </Settings>
          </InstanceSettings>
          <Expression>
            <Or>
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <XPathQuery>Values/KeyExists</XPathQuery>
                  </ValueExpression>
                  <Operator>Equal</Operator>
                  <ValueExpression>
                    <Value>true</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <XPathQuery>Values/KeyExists2</XPathQuery>
                  </ValueExpression>
                  <Operator>Equal</Operator>
                  <ValueExpression>
                    <Value>true</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
            </Or>
          </Expression>
        </DataSource>
      </Discovery>
      <Discovery ID="Windows.Server.Webservice.BasicWatcher.Discovery.Windows.Server.Webservice.Computer.FTP.IIS" Target="Windows!Microsoft.Windows.Computer" Enabled="false" ConfirmDelivery="false" Remotable="true" Priority="Normal">
        <Category>Discovery</Category>
        <DiscoveryTypes>
          <DiscoveryClass TypeID="Windows.Server.Webservice.BasicWatcher.Computer.FTP.IIS" />
        </DiscoveryTypes>
        <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.FilteredRegistryDiscoveryProvider">
          <ComputerName>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
          <RegistryAttributeDefinitions>
            <RegistryAttributeDefinition>
              <AttributeName>KeyExists</AttributeName>
              <Path>System\CurrentControlSet\Services\ftpsvc</Path>
              <PathType>0</PathType>
              <AttributeType>0</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>WindowsVersion</AttributeName>
              <Path>SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProductName</Path>
              <PathType>1</PathType>
              <AttributeType>1</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>Description</AttributeName>
              <Path>SYSTEM\CurrentControlSet\services\LanmanServer\Parameters\srvcomment</Path>
              <PathType>1</PathType>
              <AttributeType>1</AttributeType>
            </RegistryAttributeDefinition>
          </RegistryAttributeDefinitions>
          <Frequency>86400</Frequency>
          <ClassId>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer.FTP.IIS"]$</ClassId>
          <InstanceSettings>
            <Settings>
              <Setting>
                <Name>$MPElement[Name="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="System!System.Entity"]/DisplayName$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/ComputerName$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/WindowsVersion$</Name>
                <Value>$Data/Values/WindowsVersion$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/Description$</Name>
                <Value>$Data/Values/Description$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/IP$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/IPAddress$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Windows.Server.Webservice.BasicWatcher.Computer"]/OU$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/OrganizationalUnit$</Value>
              </Setting>
            </Settings>
          </InstanceSettings>
          <Expression>
            <SimpleExpression>
              <ValueExpression>
                <XPathQuery>Values/KeyExists</XPathQuery>
              </ValueExpression>
              <Operator>Equal</Operator>
              <ValueExpression>
                <Value>true</Value>
              </ValueExpression>
            </SimpleExpression>
          </Expression>
        </DataSource>
      </Discovery>
    </Discoveries>
    <Rules>
      <Rule ID="Windows.Server.Webservice.BasicWatcher.Perf.Apache.PercentProcessorTime" Target="Windows.Server.Webservice.BasicWatcher.Computer.Apache" Enabled="true" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>None</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="BasicWatcher.WebService.DataSource.KPIs.Cookdown">
            <IntervalSeconds>1800</IntervalSeconds>
            <MonitorItem>httpd</MonitorItem>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="CD" TypeID="Basic.WebService.SpecificCounterPerfFilterMapper">
          <InterestingCounter>PercentProcessorTime</InterestingCounter>
          <ObjectName>$Data/Property[@Name='Objekt']$</ObjectName>
          <CounterName>$Data/Property[@Name='Counter']$</CounterName>
          <InstanceName>$Data/Property[@Name='Instance']$</InstanceName>
          <Value>$Data/Property[@Name='Value']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="MSDL!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
      <Rule ID="Windows.Server.Webservice.BasicWatcher.Perf.ApacheTomcat.IODataMBPerSec" Target="Windows.Server.Webservice.BasicWatcher.Computer.ApacheTomcat" Enabled="false" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>None</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="BasicWatcher.WebService.DataSource.KPIs.Cookdown">
            <IntervalSeconds>1800</IntervalSeconds>
            <MonitorItem>Tomcat</MonitorItem>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="CD" TypeID="Basic.WebService.SpecificCounterPerfFilterMapper">
          <InterestingCounter>IODataMBPerSec</InterestingCounter>
          <ObjectName>$Data/Property[@Name='Objekt']$</ObjectName>
          <CounterName>$Data/Property[@Name='Counter']$</CounterName>
          <InstanceName>$Data/Property[@Name='Instance']$</InstanceName>
          <Value>$Data/Property[@Name='Value']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="MSDL!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
      <Rule ID="Windows.Server.Webservice.BasicWatcher.Perf.ApacheTomcat.WorkingSetPrivateMB" Target="Windows.Server.Webservice.BasicWatcher.Computer.ApacheTomcat" Enabled="true" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>None</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="BasicWatcher.WebService.DataSource.KPIs.Cookdown">
            <IntervalSeconds>1800</IntervalSeconds>
            <MonitorItem>Tomcat</MonitorItem>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="CD" TypeID="Basic.WebService.SpecificCounterPerfFilterMapper">
          <InterestingCounter>WorkingSetPrivateMB</InterestingCounter>
          <ObjectName>$Data/Property[@Name='Objekt']$</ObjectName>
          <CounterName>$Data/Property[@Name='Counter']$</CounterName>
          <InstanceName>$Data/Property[@Name='Instance']$</InstanceName>
          <Value>$Data/Property[@Name='Value']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="MSDL!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
      <Rule ID="Windows.Server.Webservice.BasicWatcher.Perf.ApacheTomcat.PercentProcessorTime" Target="Windows.Server.Webservice.BasicWatcher.Computer.ApacheTomcat" Enabled="true" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>None</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="BasicWatcher.WebService.DataSource.KPIs.Cookdown">
            <IntervalSeconds>1800</IntervalSeconds>
            <MonitorItem>Tomcat</MonitorItem>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="CD" TypeID="Basic.WebService.SpecificCounterPerfFilterMapper">
          <InterestingCounter>PercentProcessorTime</InterestingCounter>
          <ObjectName>$Data/Property[@Name='Objekt']$</ObjectName>
          <CounterName>$Data/Property[@Name='Counter']$</CounterName>
          <InstanceName>$Data/Property[@Name='Instance']$</InstanceName>
          <Value>$Data/Property[@Name='Value']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="MSDL!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
      <Rule ID="Windows.Server.Webservice.BasicWatcher.Perf.ApacheTomcat.HandleCount" Target="Windows.Server.Webservice.BasicWatcher.Computer.ApacheTomcat" Enabled="false" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>None</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="BasicWatcher.WebService.DataSource.KPIs.Cookdown">
            <IntervalSeconds>1800</IntervalSeconds>
            <MonitorItem>Tomcat</MonitorItem>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="CD" TypeID="Basic.WebService.SpecificCounterPerfFilterMapper">
          <InterestingCounter>HandleCount</InterestingCounter>
          <ObjectName>$Data/Property[@Name='Objekt']$</ObjectName>
          <CounterName>$Data/Property[@Name='Counter']$</CounterName>
          <InstanceName>$Data/Property[@Name='Instance']$</InstanceName>
          <Value>$Data/Property[@Name='Value']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="MSDL!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
      <Rule ID="Windows.Server.Webservice.BasicWatcher.Perf.ApacheTomcat.IPConnections" Target="Windows.Server.Webservice.BasicWatcher.Computer.ApacheTomcat" Enabled="true" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>None</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="BasicWatcher.WebService.DataSource.IPConnections.Cookdown">
            <IntervalSeconds>300</IntervalSeconds>
            <MonitorItem>tomcat</MonitorItem>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="CD" TypeID="Basic.WebService.SpecificCounterPerfFilterMapper">
          <InterestingCounter>ipConnections</InterestingCounter>
          <ObjectName>$Data/Property[@Name='Objekt']$</ObjectName>
          <CounterName>$Data/Property[@Name='Counter']$</CounterName>
          <InstanceName>$Data/Property[@Name='Instance']$</InstanceName>
          <Value>$Data/Property[@Name='Value']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="MSDL!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
      <Rule ID="Windows.Server.Webservice.BasicWatcher.Perf.Apache.WorkingSetPrivateMB" Target="Windows.Server.Webservice.BasicWatcher.Computer.Apache" Enabled="true" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>None</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="BasicWatcher.WebService.DataSource.KPIs.Cookdown">
            <IntervalSeconds>1800</IntervalSeconds>
            <MonitorItem>httpd</MonitorItem>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="CD" TypeID="Basic.WebService.SpecificCounterPerfFilterMapper">
          <InterestingCounter>WorkingSetPrivateMB</InterestingCounter>
          <ObjectName>$Data/Property[@Name='Objekt']$</ObjectName>
          <CounterName>$Data/Property[@Name='Counter']$</CounterName>
          <InstanceName>$Data/Property[@Name='Instance']$</InstanceName>
          <Value>$Data/Property[@Name='Value']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="MSDL!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
      <Rule ID="Windows.Server.Webservice.BasicWatcher.Perf.Apache.IODataMBPerSec" Target="Windows.Server.Webservice.BasicWatcher.Computer.Apache" Enabled="false" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>None</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="BasicWatcher.WebService.DataSource.KPIs.Cookdown">
            <IntervalSeconds>1800</IntervalSeconds>
            <MonitorItem>httpd</MonitorItem>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="CD" TypeID="Basic.WebService.SpecificCounterPerfFilterMapper">
          <InterestingCounter>IODataMBPerSec</InterestingCounter>
          <ObjectName>$Data/Property[@Name='Objekt']$</ObjectName>
          <CounterName>$Data/Property[@Name='Counter']$</CounterName>
          <InstanceName>$Data/Property[@Name='Instance']$</InstanceName>
          <Value>$Data/Property[@Name='Value']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="MSDL!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
      <Rule ID="Windows.Server.Webservice.BasicWatcher.Perf.IIS.Web.WorkingSetPrivateMB" Target="Windows.Server.Webservice.BasicWatcher.Computer.IIS" Enabled="true" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>None</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="BasicWatcher.WebService.DataSource.KPIs.Cookdown">
            <IntervalSeconds>300</IntervalSeconds>
            <MonitorItem>w3wp</MonitorItem>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="CD" TypeID="Basic.WebService.SpecificCounterPerfFilterMapper">
          <InterestingCounter>WorkingSetPrivateMB</InterestingCounter>
          <ObjectName>$Data/Property[@Name='Objekt']$</ObjectName>
          <CounterName>$Data/Property[@Name='Counter']$</CounterName>
          <InstanceName>$Data/Property[@Name='Instance']$</InstanceName>
          <Value>$Data/Property[@Name='Value']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="MSDL!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
      <Rule ID="Windows.Server.Webservice.BasicWatcher.Perf.IIS.Web.IPConnections" Target="Windows.Server.Webservice.BasicWatcher.Computer.IIS" Enabled="true" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>None</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="BasicWatcher.WebService.DataSource.IPConnections.Cookdown">
            <IntervalSeconds>300</IntervalSeconds>
            <MonitorItem>w3wp</MonitorItem>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="CD" TypeID="Basic.WebService.SpecificCounterPerfFilterMapper">
          <InterestingCounter>ipConnections</InterestingCounter>
          <ObjectName>$Data/Property[@Name='Objekt']$</ObjectName>
          <CounterName>$Data/Property[@Name='Counter']$</CounterName>
          <InstanceName>$Data/Property[@Name='Instance']$</InstanceName>
          <Value>$Data/Property[@Name='Value']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="MSDL!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
      <Rule ID="Windows.Server.Webservice.BasicWatcher.Perf.Apache.HandleCount" Target="Windows.Server.Webservice.BasicWatcher.Computer.Apache" Enabled="false" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>None</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="BasicWatcher.WebService.DataSource.KPIs.Cookdown">
            <IntervalSeconds>1800</IntervalSeconds>
            <MonitorItem>httpd</MonitorItem>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="CD" TypeID="Basic.WebService.SpecificCounterPerfFilterMapper">
          <InterestingCounter>HandleCount</InterestingCounter>
          <ObjectName>$Data/Property[@Name='Objekt']$</ObjectName>
          <CounterName>$Data/Property[@Name='Counter']$</CounterName>
          <InstanceName>$Data/Property[@Name='Instance']$</InstanceName>
          <Value>$Data/Property[@Name='Value']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="MSDL!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
      <Rule ID="Windows.Server.Webservice.BasicWatcher.Perf.IIS.Web.IODataMBPerSec" Target="Windows.Server.Webservice.BasicWatcher.Computer.IIS" Enabled="false" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>None</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="BasicWatcher.WebService.DataSource.KPIs.Cookdown">
            <IntervalSeconds>300</IntervalSeconds>
            <MonitorItem>w3wp</MonitorItem>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="CD" TypeID="Basic.WebService.SpecificCounterPerfFilterMapper">
          <InterestingCounter>IODataMBPerSec</InterestingCounter>
          <ObjectName>$Data/Property[@Name='Objekt']$</ObjectName>
          <CounterName>$Data/Property[@Name='Counter']$</CounterName>
          <InstanceName>$Data/Property[@Name='Instance']$</InstanceName>
          <Value>$Data/Property[@Name='Value']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="MSDL!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
      <Rule ID="Windows.Server.Webservice.BasicWatcher.Perf.IIS.Web.PercentProcessorTime" Target="Windows.Server.Webservice.BasicWatcher.Computer.IIS" Enabled="true" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>None</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="BasicWatcher.WebService.DataSource.KPIs.Cookdown">
            <IntervalSeconds>300</IntervalSeconds>
            <MonitorItem>w3wp</MonitorItem>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="CD" TypeID="Basic.WebService.SpecificCounterPerfFilterMapper">
          <InterestingCounter>PercentProcessorTime</InterestingCounter>
          <ObjectName>$Data/Property[@Name='Objekt']$</ObjectName>
          <CounterName>$Data/Property[@Name='Counter']$</CounterName>
          <InstanceName>$Data/Property[@Name='Instance']$</InstanceName>
          <Value>$Data/Property[@Name='Value']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="MSDL!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
      <Rule ID="Windows.Server.Webservice.BasicWatcher.Perf.IIS.Web.HandleCount" Target="Windows.Server.Webservice.BasicWatcher.Computer.IIS" Enabled="false" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>None</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="BasicWatcher.WebService.DataSource.KPIs.Cookdown">
            <IntervalSeconds>300</IntervalSeconds>
            <MonitorItem>w3wp</MonitorItem>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="CD" TypeID="Basic.WebService.SpecificCounterPerfFilterMapper">
          <InterestingCounter>HandleCount</InterestingCounter>
          <ObjectName>$Data/Property[@Name='Objekt']$</ObjectName>
          <CounterName>$Data/Property[@Name='Counter']$</CounterName>
          <InstanceName>$Data/Property[@Name='Instance']$</InstanceName>
          <Value>$Data/Property[@Name='Value']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="MSDL!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
      <Rule ID="Windows.Server.Webservice.BasicWatcher.Perf.Apache.IPConnections" Target="Windows.Server.Webservice.BasicWatcher.Computer.Apache" Enabled="true" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>None</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="BasicWatcher.WebService.DataSource.IPConnections.Cookdown">
            <IntervalSeconds>300</IntervalSeconds>
            <MonitorItem>httpd</MonitorItem>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="CD" TypeID="Basic.WebService.SpecificCounterPerfFilterMapper">
          <InterestingCounter>ipConnections</InterestingCounter>
          <ObjectName>$Data/Property[@Name='Objekt']$</ObjectName>
          <CounterName>$Data/Property[@Name='Counter']$</CounterName>
          <InstanceName>$Data/Property[@Name='Instance']$</InstanceName>
          <Value>$Data/Property[@Name='Value']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="MSDL!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
    </Rules>
    <Monitors>
      <UnitMonitor ID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.ApacheTomcat" Accessibility="Internal" Enabled="true" Target="Windows.Server.Webservice.BasicWatcher.Computer.ApacheTomcat" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.TimedScript.ThreeStateMonitorType" ConfirmDelivery="false">
        <Category>AvailabilityHealth</Category>
        <AlertSettings AlertMessage="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.ApacheTomcat.AlertMessage">
          <AlertOnState>Error</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
          <AlertParameters>
            <AlertParameter1>$Data/Context/Property[@Name='Description']$</AlertParameter1>
            <AlertParameter2>$Data/Context/Property[@Name='OU']$</AlertParameter2>
            <AlertParameter3>$Data/Context/Property[@Name='ServiceDescription']$</AlertParameter3>
            <AlertParameter4>$Data/Context/Property[@Name='Message']$</AlertParameter4>
            <AlertParameter5>$Data/Context/Property[@Name='Result']$</AlertParameter5>
          </AlertParameters>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Error" MonitorTypeStateID="Error" HealthState="Error" />
          <OperationalState ID="Warning" MonitorTypeStateID="Warning" HealthState="Warning" />
          <OperationalState ID="Success" MonitorTypeStateID="Success" HealthState="Success" />
        </OperationalStates>
        <Configuration>
          <IntervalSeconds>180</IntervalSeconds>
          <SyncTime />
          <ScriptName>BasicWatcher.WebService.Monitor.vbs</ScriptName>
          <Arguments>Tomcat</Arguments>
          <ScriptBody><![CDATA[strServiceWildcard = WScript.Arguments(0)

Set WshNetwork       = CreateObject("WScript.Network")
ComputerName         = WshNetwork.ComputerName

Set objADSysInfo     = CreateObject("ADSystemInfo")
strComputerName      = objADSysInfo.ComputerName

Set objComputer      = GetObject("LDAP://" & strComputerName)
strDistinguishedName = objComputer.DistinguishedName

Set objAPI         = CreateObject("MOM.ScriptAPI")
Set objBag         = objAPI.CreatePropertyBag()

strReplaceMentText = "CN=" & ComputerName &","
strOUName          = Replace(strDistinguishedName,strReplaceMentText,"")


strWQL       = "SELECT * FROM Win32_Service WHERE Name LIKE '%" &strServiceWildcard & "%'"
strComputer  = "."

Set objWMIService = GetObject("winmgmts:" _
    & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")

Set colRunningServices = objWMIService.ExecQuery(strWQL)

For Each objService In colRunningServices 
    strServiceState       = objService.State 
	strMsg                = "Service State: " & strServiceState  
    strServiceDescription = objService.Description 
    strStartupMode        = objService.StartMode
Next

If strStartupMode = "Disabled" Then
	strRslt = "DisabledOrManual"
	strMsg = strMsg & VbCrLf & " please clean configuration instead of disabling service. "
ElseIf strStartupMode = "Manual" Then
	strRslt = "DisabledOrManual"
	strMsg = strMsg & VbCrLf & " Startup Mode is Manual. Cannot judge service state. "
Else
	If strServiceState <> "Running" Then
		strRslt = "Stopped"
	Else 
		strRslt = "Running"
	End If
End If

'objAPI.LogScriptEvent "BasicWatcher.WebService.Monitor.vbs",402,4,"Monitor sends Result:" & strRslt & " for " & strServiceWildcard & " with msg: " & strMsg

strDescription = "Not Maintained"

Set colItems = objWMIService.ExecQuery("Select * from Win32_OperatingSystem",,48)
For Each objItem In colItems
    strDescription = objItem.Description
Next 

Call objBag.AddValue("Result", strRslt)
Call objBag.AddValue("Message", strMsg)
Call objBag.AddValue("ServiceDescription", strServiceDescription)
Call objBag.AddValue("Description", strDescription)
Call objBag.AddValue("OU", strOUName)

objAPI.AddItem(objBag)

objAPI.ReturnItems]]></ScriptBody>
          <TimeoutSeconds>30</TimeoutSeconds>
          <ErrorExpression>
            <SimpleExpression>
              <ValueExpression>
                <XPathQuery Type="String">Property[@Name='Result']</XPathQuery>
              </ValueExpression>
              <Operator>Equal</Operator>
              <ValueExpression>
                <Value Type="String">Stopped</Value>
              </ValueExpression>
            </SimpleExpression>
          </ErrorExpression>
          <WarningExpression>
            <SimpleExpression>
              <ValueExpression>
                <XPathQuery Type="String">Property[@Name='Result']</XPathQuery>
              </ValueExpression>
              <Operator>Equal</Operator>
              <ValueExpression>
                <Value Type="String">DisabledOrManual</Value>
              </ValueExpression>
            </SimpleExpression>
          </WarningExpression>
          <SuccessExpression>
            <SimpleExpression>
              <ValueExpression>
                <XPathQuery Type="String">Property[@Name='Result']</XPathQuery>
              </ValueExpression>
              <Operator>Equal</Operator>
              <ValueExpression>
                <Value Type="String">Running</Value>
              </ValueExpression>
            </SimpleExpression>
          </SuccessExpression>
        </Configuration>
      </UnitMonitor>
      <UnitMonitor ID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.Apache" Accessibility="Internal" Enabled="true" Target="Windows.Server.Webservice.BasicWatcher.Computer.Apache" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.TimedScript.ThreeStateMonitorType" ConfirmDelivery="false">
        <Category>AvailabilityHealth</Category>
        <AlertSettings AlertMessage="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.Apache.AlertMessage">
          <AlertOnState>Error</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
          <AlertParameters>
            <AlertParameter1>$Data/Context/Property[@Name='Description']$</AlertParameter1>
            <AlertParameter2>$Data/Context/Property[@Name='OU']$</AlertParameter2>
            <AlertParameter3>$Data/Context/Property[@Name='ServiceDescription']$</AlertParameter3>
            <AlertParameter4>$Data/Context/Property[@Name='Message']$</AlertParameter4>
            <AlertParameter5>$Data/Context/Property[@Name='Result']$</AlertParameter5>
          </AlertParameters>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Error" MonitorTypeStateID="Error" HealthState="Error" />
          <OperationalState ID="Warning" MonitorTypeStateID="Warning" HealthState="Warning" />
          <OperationalState ID="Success" MonitorTypeStateID="Success" HealthState="Success" />
        </OperationalStates>
        <Configuration>
          <IntervalSeconds>180</IntervalSeconds>
          <SyncTime />
          <ScriptName>BasicWatcher.WebService.Monitor.vbs</ScriptName>
          <Arguments>Apache</Arguments>
          <ScriptBody><![CDATA[strServiceWildcard = WScript.Arguments(0)

Set WshNetwork       = CreateObject("WScript.Network")
ComputerName         = WshNetwork.ComputerName

Set objADSysInfo     = CreateObject("ADSystemInfo")
strComputerName      = objADSysInfo.ComputerName

Set objComputer      = GetObject("LDAP://" & strComputerName)
strDistinguishedName = objComputer.DistinguishedName

Set objAPI         = CreateObject("MOM.ScriptAPI")
Set objBag         = objAPI.CreatePropertyBag()

strReplaceMentText = "CN=" & ComputerName &","
strOUName          = Replace(strDistinguishedName,strReplaceMentText,"")


strWQL       = "SELECT * FROM Win32_Service WHERE Name LIKE '%" &strServiceWildcard & "%'"
strComputer  = "."

Set objWMIService = GetObject("winmgmts:" _
    & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")

Set colRunningServices = objWMIService.ExecQuery(strWQL)

For Each objService In colRunningServices 
    strServiceState       = objService.State 
	strMsg                = "Service State: " & strServiceState  
    strServiceDescription = objService.Description 
    strStartupMode        = objService.StartMode
Next

If strStartupMode = "Disabled" Then
	strRslt = "DisabledOrManual"
	strMsg = strMsg & VbCrLf & " please clean configuration instead of disabling service. "
ElseIf strStartupMode = "Manual" Then
	strRslt = "DisabledOrManual"
	strMsg = strMsg & VbCrLf & " Startup Mode is Manual. Cannot judge service state. "
Else
	If strServiceState <> "Running" Then
		strRslt = "Stopped"
	Else 
		strRslt = "Running"
	End If
End If

'objAPI.LogScriptEvent "BasicWatcher.WebService.Monitor.vbs",402,4,"Monitor sends Result:" & strRslt & " for " & strServiceWildcard & " with msg: " & strMsg

strDescription = "Not Maintained"

Set colItems = objWMIService.ExecQuery("Select * from Win32_OperatingSystem",,48)
For Each objItem In colItems
    strDescription = objItem.Description
Next 

Call objBag.AddValue("Result", strRslt)
Call objBag.AddValue("Message", strMsg)
Call objBag.AddValue("ServiceDescription", strServiceDescription)
Call objBag.AddValue("Description", strDescription)
Call objBag.AddValue("OU", strOUName)

objAPI.AddItem(objBag)

objAPI.ReturnItems]]></ScriptBody>
          <TimeoutSeconds>30</TimeoutSeconds>
          <ErrorExpression>
            <SimpleExpression>
              <ValueExpression>
                <XPathQuery Type="String">Property[@Name='Result']</XPathQuery>
              </ValueExpression>
              <Operator>Equal</Operator>
              <ValueExpression>
                <Value Type="String">Stopped</Value>
              </ValueExpression>
            </SimpleExpression>
          </ErrorExpression>
          <WarningExpression>
            <SimpleExpression>
              <ValueExpression>
                <XPathQuery Type="String">Property[@Name='Result']</XPathQuery>
              </ValueExpression>
              <Operator>Equal</Operator>
              <ValueExpression>
                <Value Type="String">DisabledOrManual</Value>
              </ValueExpression>
            </SimpleExpression>
          </WarningExpression>
          <SuccessExpression>
            <SimpleExpression>
              <ValueExpression>
                <XPathQuery Type="String">Property[@Name='Result']</XPathQuery>
              </ValueExpression>
              <Operator>Equal</Operator>
              <ValueExpression>
                <Value Type="String">Running</Value>
              </ValueExpression>
            </SimpleExpression>
          </SuccessExpression>
        </Configuration>
      </UnitMonitor>
      <UnitMonitor ID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.FTP.ServU" Accessibility="Internal" Enabled="true" Target="Windows.Server.Webservice.BasicWatcher.Computer.FTP.ServU" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.TimedScript.ThreeStateMonitorType" ConfirmDelivery="false">
        <Category>AvailabilityHealth</Category>
        <AlertSettings AlertMessage="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.FTP.ServU.AlertMessage">
          <AlertOnState>Error</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
          <AlertParameters>
            <AlertParameter1>$Data/Context/Property[@Name='Description']$</AlertParameter1>
            <AlertParameter2>$Data/Context/Property[@Name='OU']$</AlertParameter2>
            <AlertParameter3>$Data/Context/Property[@Name='ServiceDescription']$</AlertParameter3>
            <AlertParameter4>$Data/Context/Property[@Name='Message']$</AlertParameter4>
            <AlertParameter5>$Data/Context/Property[@Name='Result']$</AlertParameter5>
          </AlertParameters>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Error" MonitorTypeStateID="Error" HealthState="Error" />
          <OperationalState ID="Warning" MonitorTypeStateID="Warning" HealthState="Warning" />
          <OperationalState ID="Success" MonitorTypeStateID="Success" HealthState="Success" />
        </OperationalStates>
        <Configuration>
          <IntervalSeconds>180</IntervalSeconds>
          <SyncTime />
          <ScriptName>BasicWatcher.WebService.Monitor.vbs</ScriptName>
          <Arguments>Serv-U</Arguments>
          <ScriptBody><![CDATA[strServiceWildcard = WScript.Arguments(0)

Set WshNetwork       = CreateObject("WScript.Network")
ComputerName         = WshNetwork.ComputerName

Set objADSysInfo     = CreateObject("ADSystemInfo")
strComputerName      = objADSysInfo.ComputerName

Set objComputer      = GetObject("LDAP://" & strComputerName)
strDistinguishedName = objComputer.DistinguishedName

Set objAPI         = CreateObject("MOM.ScriptAPI")
Set objBag         = objAPI.CreatePropertyBag()

strReplaceMentText = "CN=" & ComputerName &","
strOUName          = Replace(strDistinguishedName,strReplaceMentText,"")


strWQL       = "SELECT * FROM Win32_Service WHERE Name LIKE '%" &strServiceWildcard & "%'"
strComputer  = "."

Set objWMIService = GetObject("winmgmts:" _
    & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")

Set colRunningServices = objWMIService.ExecQuery(strWQL)

For Each objService In colRunningServices 
    strServiceState       = objService.State 
	strMsg                = "Service State: " & strServiceState  
    strServiceDescription = objService.Description 
    strStartupMode        = objService.StartMode
Next

If strStartupMode = "Disabled" Then
	strRslt = "DisabledOrManual"
	strMsg = strMsg & VbCrLf & " please clean configuration instead of disabling service. "
ElseIf strStartupMode = "Manual" Then
	strRslt = "DisabledOrManual"
	strMsg = strMsg & VbCrLf & " Startup Mode is Manual. Cannot judge service state. "
Else
	If strServiceState <> "Running" Then
		strRslt = "Stopped"
	Else 
		strRslt = "Running"
	End If
End If

'objAPI.LogScriptEvent "BasicWatcher.WebService.Monitor.vbs",402,4,"Monitor sends Result:" & strRslt & " for " & strServiceWildcard & " with msg: " & strMsg

strDescription = "Not Maintained"

Set colItems = objWMIService.ExecQuery("Select * from Win32_OperatingSystem",,48)
For Each objItem In colItems
    strDescription = objItem.Description
Next 

Call objBag.AddValue("Result", strRslt)
Call objBag.AddValue("Message", strMsg)
Call objBag.AddValue("ServiceDescription", strServiceDescription)
Call objBag.AddValue("Description", strDescription)
Call objBag.AddValue("OU", strOUName)

objAPI.AddItem(objBag)

objAPI.ReturnItems]]></ScriptBody>
          <TimeoutSeconds>30</TimeoutSeconds>
          <ErrorExpression>
            <SimpleExpression>
              <ValueExpression>
                <XPathQuery Type="String">Property[@Name='Result']</XPathQuery>
              </ValueExpression>
              <Operator>Equal</Operator>
              <ValueExpression>
                <Value Type="String">Stopped</Value>
              </ValueExpression>
            </SimpleExpression>
          </ErrorExpression>
          <WarningExpression>
            <SimpleExpression>
              <ValueExpression>
                <XPathQuery Type="String">Property[@Name='Result']</XPathQuery>
              </ValueExpression>
              <Operator>Equal</Operator>
              <ValueExpression>
                <Value Type="String">DisabledOrManual</Value>
              </ValueExpression>
            </SimpleExpression>
          </WarningExpression>
          <SuccessExpression>
            <SimpleExpression>
              <ValueExpression>
                <XPathQuery Type="String">Property[@Name='Result']</XPathQuery>
              </ValueExpression>
              <Operator>Equal</Operator>
              <ValueExpression>
                <Value Type="String">Running</Value>
              </ValueExpression>
            </SimpleExpression>
          </SuccessExpression>
        </Configuration>
      </UnitMonitor>
      <UnitMonitor ID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.IIS" Accessibility="Internal" Enabled="true" Target="Windows.Server.Webservice.BasicWatcher.Computer.IIS" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.TimedScript.ThreeStateMonitorType" ConfirmDelivery="false">
        <Category>AvailabilityHealth</Category>
        <AlertSettings AlertMessage="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.IIS.AlertMessage">
          <AlertOnState>Error</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
          <AlertParameters>
            <AlertParameter1>$Data/Context/Property[@Name='Description']$</AlertParameter1>
            <AlertParameter2>$Data/Context/Property[@Name='OU']$</AlertParameter2>
            <AlertParameter3>$Data/Context/Property[@Name='ServiceDescription']$</AlertParameter3>
            <AlertParameter4>$Data/Context/Property[@Name='Message']$</AlertParameter4>
            <AlertParameter5>$Data/Context/Property[@Name='Result']$</AlertParameter5>
          </AlertParameters>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Error" MonitorTypeStateID="Error" HealthState="Error" />
          <OperationalState ID="Warning" MonitorTypeStateID="Warning" HealthState="Warning" />
          <OperationalState ID="Success" MonitorTypeStateID="Success" HealthState="Success" />
        </OperationalStates>
        <Configuration>
          <IntervalSeconds>180</IntervalSeconds>
          <SyncTime />
          <ScriptName>BasicWatcher.WebService.Monitor.vbs</ScriptName>
          <Arguments>W3SVC</Arguments>
          <ScriptBody><![CDATA[strServiceWildcard = WScript.Arguments(0)

Set WshNetwork       = CreateObject("WScript.Network")
ComputerName         = WshNetwork.ComputerName

Set objADSysInfo     = CreateObject("ADSystemInfo")
strComputerName      = objADSysInfo.ComputerName

Set objComputer      = GetObject("LDAP://" & strComputerName)
strDistinguishedName = objComputer.DistinguishedName

Set objAPI         = CreateObject("MOM.ScriptAPI")
Set objBag         = objAPI.CreatePropertyBag()

strReplaceMentText = "CN=" & ComputerName &","
strOUName          = Replace(strDistinguishedName,strReplaceMentText,"")


strWQL       = "SELECT * FROM Win32_Service WHERE Name LIKE '%" &strServiceWildcard & "%'"
strComputer  = "."

Set objWMIService = GetObject("winmgmts:" _
    & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")

Set colRunningServices = objWMIService.ExecQuery(strWQL)

For Each objService In colRunningServices 
    strServiceState       = objService.State 
	strMsg                = "Service State: " & strServiceState  
    strServiceDescription = objService.Description 
    strStartupMode        = objService.StartMode
Next

If strStartupMode = "Disabled" Then
	strRslt = "DisabledOrManual"
	strMsg = strMsg & VbCrLf & " please clean configuration instead of disabling service. "
ElseIf strStartupMode = "Manual" Then
	strRslt = "DisabledOrManual"
	strMsg = strMsg & VbCrLf & " Startup Mode is Manual. Cannot judge service state. "
Else
	If strServiceState <> "Running" Then
		strRslt = "Stopped"
	Else 
		strRslt = "Running"
	End If
End If

'objAPI.LogScriptEvent "BasicWatcher.WebService.Monitor.vbs",402,4,"Monitor sends Result:" & strRslt & " for " & strServiceWildcard & " with msg: " & strMsg

strDescription = "Not Maintained"

Set colItems = objWMIService.ExecQuery("Select * from Win32_OperatingSystem",,48)
For Each objItem In colItems
    strDescription = objItem.Description
Next 

Call objBag.AddValue("Result", strRslt)
Call objBag.AddValue("Message", strMsg)
Call objBag.AddValue("ServiceDescription", strServiceDescription)
Call objBag.AddValue("Description", strDescription)
Call objBag.AddValue("OU", strOUName)

objAPI.AddItem(objBag)

objAPI.ReturnItems]]></ScriptBody>
          <TimeoutSeconds>30</TimeoutSeconds>
          <ErrorExpression>
            <SimpleExpression>
              <ValueExpression>
                <XPathQuery Type="String">Property[@Name='Result']</XPathQuery>
              </ValueExpression>
              <Operator>Equal</Operator>
              <ValueExpression>
                <Value Type="String">Stopped</Value>
              </ValueExpression>
            </SimpleExpression>
          </ErrorExpression>
          <WarningExpression>
            <SimpleExpression>
              <ValueExpression>
                <XPathQuery Type="String">Property[@Name='Result']</XPathQuery>
              </ValueExpression>
              <Operator>Equal</Operator>
              <ValueExpression>
                <Value Type="String">DisabledOrManual</Value>
              </ValueExpression>
            </SimpleExpression>
          </WarningExpression>
          <SuccessExpression>
            <SimpleExpression>
              <ValueExpression>
                <XPathQuery Type="String">Property[@Name='Result']</XPathQuery>
              </ValueExpression>
              <Operator>Equal</Operator>
              <ValueExpression>
                <Value Type="String">Running</Value>
              </ValueExpression>
            </SimpleExpression>
          </SuccessExpression>
        </Configuration>
      </UnitMonitor>
      <UnitMonitor ID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.FTP.IIS" Accessibility="Internal" Enabled="true" Target="Windows.Server.Webservice.BasicWatcher.Computer.FTP.IIS" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.TimedScript.ThreeStateMonitorType" ConfirmDelivery="false">
        <Category>AvailabilityHealth</Category>
        <AlertSettings AlertMessage="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.FTP.IIS.AlertMessage">
          <AlertOnState>Error</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
          <AlertParameters>
            <AlertParameter1>$Data/Context/Property[@Name='Description']$</AlertParameter1>
            <AlertParameter2>$Data/Context/Property[@Name='OU']$</AlertParameter2>
            <AlertParameter3>$Data/Context/Property[@Name='ServiceDescription']$</AlertParameter3>
            <AlertParameter4>$Data/Context/Property[@Name='Message']$</AlertParameter4>
            <AlertParameter5>$Data/Context/Property[@Name='Result']$</AlertParameter5>
          </AlertParameters>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Error" MonitorTypeStateID="Error" HealthState="Error" />
          <OperationalState ID="Warning" MonitorTypeStateID="Warning" HealthState="Warning" />
          <OperationalState ID="Success" MonitorTypeStateID="Success" HealthState="Success" />
        </OperationalStates>
        <Configuration>
          <IntervalSeconds>180</IntervalSeconds>
          <SyncTime />
          <ScriptName>BasicWatcher.WebService.Monitor.vbs</ScriptName>
          <Arguments>ftpsvc</Arguments>
          <ScriptBody><![CDATA[strServiceWildcard = WScript.Arguments(0)

Set WshNetwork       = CreateObject("WScript.Network")
ComputerName         = WshNetwork.ComputerName

Set objADSysInfo     = CreateObject("ADSystemInfo")
strComputerName      = objADSysInfo.ComputerName

Set objComputer      = GetObject("LDAP://" & strComputerName)
strDistinguishedName = objComputer.DistinguishedName

Set objAPI         = CreateObject("MOM.ScriptAPI")
Set objBag         = objAPI.CreatePropertyBag()

strReplaceMentText = "CN=" & ComputerName &","
strOUName          = Replace(strDistinguishedName,strReplaceMentText,"")


strWQL       = "SELECT * FROM Win32_Service WHERE Name LIKE '%" &strServiceWildcard & "%'"
strComputer  = "."

Set objWMIService = GetObject("winmgmts:" _
    & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")

Set colRunningServices = objWMIService.ExecQuery(strWQL)

For Each objService In colRunningServices 
    strServiceState       = objService.State 
	strMsg                = "Service State: " & strServiceState  
    strServiceDescription = objService.Description 
    strStartupMode        = objService.StartMode
Next

If strStartupMode = "Disabled" Then
	strRslt = "DisabledOrManual"
	strMsg = strMsg & VbCrLf & " please clean configuration instead of disabling service. "
ElseIf strStartupMode = "Manual" Then
	strRslt = "DisabledOrManual"
	strMsg = strMsg & VbCrLf & " Startup Mode is Manual. Cannot judge service state. "
Else
	If strServiceState <> "Running" Then
		strRslt = "Stopped"
	Else 
		strRslt = "Running"
	End If
End If

'objAPI.LogScriptEvent "BasicWatcher.WebService.Monitor.vbs",402,4,"Monitor sends Result:" & strRslt & " for " & strServiceWildcard & " with msg: " & strMsg

strDescription = "Not Maintained"

Set colItems = objWMIService.ExecQuery("Select * from Win32_OperatingSystem",,48)
For Each objItem In colItems
    strDescription = objItem.Description
Next 

Call objBag.AddValue("Result", strRslt)
Call objBag.AddValue("Message", strMsg)
Call objBag.AddValue("ServiceDescription", strServiceDescription)
Call objBag.AddValue("Description", strDescription)
Call objBag.AddValue("OU", strOUName)

objAPI.AddItem(objBag)

objAPI.ReturnItems]]></ScriptBody>
          <TimeoutSeconds>30</TimeoutSeconds>
          <ErrorExpression>
            <SimpleExpression>
              <ValueExpression>
                <XPathQuery Type="String">Property[@Name='Result']</XPathQuery>
              </ValueExpression>
              <Operator>Equal</Operator>
              <ValueExpression>
                <Value Type="String">Stopped</Value>
              </ValueExpression>
            </SimpleExpression>
          </ErrorExpression>
          <WarningExpression>
            <SimpleExpression>
              <ValueExpression>
                <XPathQuery Type="String">Property[@Name='Result']</XPathQuery>
              </ValueExpression>
              <Operator>Equal</Operator>
              <ValueExpression>
                <Value Type="String">DisabledOrManual</Value>
              </ValueExpression>
            </SimpleExpression>
          </WarningExpression>
          <SuccessExpression>
            <SimpleExpression>
              <ValueExpression>
                <XPathQuery Type="String">Property[@Name='Result']</XPathQuery>
              </ValueExpression>
              <Operator>Equal</Operator>
              <ValueExpression>
                <Value Type="String">Running</Value>
              </ValueExpression>
            </SimpleExpression>
          </SuccessExpression>
        </Configuration>
      </UnitMonitor>
    </Monitors>
  </Monitoring>
  <Presentation>
    <Views>
      <View ID="Windows.Server.Webservice.BasicWatcher.View.State.Webservice.Apache" Accessibility="Internal" Target="Windows.Server.Webservice.BasicWatcher.Computer.Apache" TypeID="SC!Microsoft.SystemCenter.StateViewType" Visible="true">
        <Category>Operations</Category>
        <Presentation>
          <ColumnInfo Index="0" Grouped="false" IsSortable="true" Sorted="true" SortIndex="0" Visible="true" SortOrder="Descending" Width="120">
            <Name>Webservice State</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer.Apache</Id>
          </ColumnInfo>
          <ColumnInfo Index="1" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="180">
            <Name>ComputerName</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/ComputerName</Id>
          </ColumnInfo>
          <ColumnInfo Index="2" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="220">
            <Name>WindowsVersion</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/WindowsVersion</Id>
          </ColumnInfo>
          <ColumnInfo Index="3" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="420">
            <Name>Description</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/Description</Id>
          </ColumnInfo>
          <ColumnInfo Index="4" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="420">
            <Name>OU</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/OU</Id>
          </ColumnInfo>
        </Presentation>
      </View>
      <View ID="Windows.Server.Webservice.BasicWatcher.View.State.Webservice.ApacheTomcat" Accessibility="Internal" Target="Windows.Server.Webservice.BasicWatcher.Computer.ApacheTomcat" TypeID="SC!Microsoft.SystemCenter.StateViewType" Visible="true">
        <Category>Operations</Category>
        <Presentation>
          <ColumnInfo Index="0" Grouped="false" IsSortable="true" Sorted="true" SortIndex="0" Visible="true" SortOrder="Descending" Width="120">
            <Name>Webservice State</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer.ApacheTomcat</Id>
          </ColumnInfo>
          <ColumnInfo Index="1" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="180">
            <Name>ComputerName</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/ComputerName</Id>
          </ColumnInfo>
          <ColumnInfo Index="2" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="220">
            <Name>WindowsVersion</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/WindowsVersion</Id>
          </ColumnInfo>
          <ColumnInfo Index="3" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="420">
            <Name>Description</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/Description</Id>
          </ColumnInfo>
          <ColumnInfo Index="4" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="420">
            <Name>OU</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/OU</Id>
          </ColumnInfo>
        </Presentation>
      </View>
      <View ID="Windows.Server.Webservice.BasicWatcher.View.Alerts.FTP.IIS" Accessibility="Internal" Target="Windows.Server.Webservice.BasicWatcher.Computer.FTP.IIS" TypeID="SC!Microsoft.SystemCenter.AlertViewType" Visible="true">
        <Category>Operations</Category>
      </View>
      <View ID="Windows.Server.Webservice.BasicWatcher.View.State.Webservice.IIS" Accessibility="Internal" Target="Windows.Server.Webservice.BasicWatcher.Computer.IIS" TypeID="SC!Microsoft.SystemCenter.StateViewType" Visible="true">
        <Category>Operations</Category>
        <Presentation>
          <ColumnInfo Index="0" Grouped="false" IsSortable="true" Sorted="true" SortIndex="0" Visible="true" SortOrder="Descending" Width="120">
            <Name>Webservice State</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer.IIS</Id>
          </ColumnInfo>
          <ColumnInfo Index="1" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="180">
            <Name>ComputerName</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/ComputerName</Id>
          </ColumnInfo>
          <ColumnInfo Index="2" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="220">
            <Name>WindowsVersion</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/WindowsVersion</Id>
          </ColumnInfo>
          <ColumnInfo Index="3" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="420">
            <Name>Description</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/Description</Id>
          </ColumnInfo>
          <ColumnInfo Index="4" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="420">
            <Name>OU</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/OU</Id>
          </ColumnInfo>
        </Presentation>
      </View>
      <View ID="Windows.Server.Webservice.BasicWatcher.View.State.FTP.IIS" Accessibility="Internal" Target="Windows.Server.Webservice.BasicWatcher.Computer.FTP.IIS" TypeID="SC!Microsoft.SystemCenter.StateViewType" Visible="true">
        <Category>Operations</Category>
        <Presentation>
          <ColumnInfo Index="0" Grouped="false" IsSortable="true" Sorted="true" SortIndex="0" Visible="true" SortOrder="Descending" Width="120">
            <Name>Webservice State</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer.FTP.IIS</Id>
          </ColumnInfo>
          <ColumnInfo Index="1" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="180">
            <Name>ComputerName</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/ComputerName</Id>
          </ColumnInfo>
          <ColumnInfo Index="2" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="220">
            <Name>WindowsVersion</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/WindowsVersion</Id>
          </ColumnInfo>
          <ColumnInfo Index="3" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="420">
            <Name>Description</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/Description</Id>
          </ColumnInfo>
          <ColumnInfo Index="4" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="420">
            <Name>OU</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/OU</Id>
          </ColumnInfo>
        </Presentation>
      </View>
      <View ID="Windows.Server.Webservice.BasicWatcher.View.State.FTP.ServU" Accessibility="Internal" Target="Windows.Server.Webservice.BasicWatcher.Computer.FTP.ServU" TypeID="SC!Microsoft.SystemCenter.StateViewType" Visible="true">
        <Category>Operations</Category>
        <Presentation>
          <ColumnInfo Index="0" Grouped="false" IsSortable="true" Sorted="true" SortIndex="0" Visible="true" SortOrder="Descending" Width="120">
            <Name>Webservice State</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer.FTP.ServU</Id>
          </ColumnInfo>
          <ColumnInfo Index="1" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="180">
            <Name>ComputerName</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/ComputerName</Id>
          </ColumnInfo>
          <ColumnInfo Index="2" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="220">
            <Name>WindowsVersion</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/WindowsVersion</Id>
          </ColumnInfo>
          <ColumnInfo Index="3" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="420">
            <Name>Description</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/Description</Id>
          </ColumnInfo>
          <ColumnInfo Index="4" Grouped="false" IsSortable="true" Sorted="false" SortIndex="0" Visible="true" SortOrder="Ascending" Width="420">
            <Name>OU</Name>
            <Id>Windows.Server.Webservice.BasicWatcher.Computer/OU</Id>
          </ColumnInfo>
        </Presentation>
      </View>
      <View ID="Windows.Server.Webservice.BasicWatcher.View.Alerts.FTP.ServU" Accessibility="Internal" Target="Windows.Server.Webservice.BasicWatcher.Computer.FTP.ServU" TypeID="SC!Microsoft.SystemCenter.AlertViewType" Visible="true">
        <Category>Operations</Category>
      </View>
      <View ID="Windows.Server.Webservice.BasicWatcher.View.Alerts.WebService.IIS" Accessibility="Internal" Target="Windows.Server.Webservice.BasicWatcher.Computer.IIS" TypeID="SC!Microsoft.SystemCenter.AlertViewType" Visible="true">
        <Category>Operations</Category>
      </View>
      <View ID="Windows.Server.Webservice.BasicWatcher.View.Alerts.WebService.ApacheTomcat" Accessibility="Internal" Target="Windows.Server.Webservice.BasicWatcher.Computer.ApacheTomcat" TypeID="SC!Microsoft.SystemCenter.AlertViewType" Visible="true">
        <Category>Operations</Category>
      </View>
      <View ID="Windows.Server.Webservice.BasicWatcher.View.Alerts.WebService.Apache" Accessibility="Internal" Target="Windows.Server.Webservice.BasicWatcher.Computer.Apache" TypeID="SC!Microsoft.SystemCenter.AlertViewType" Visible="true">
        <Category>Operations</Category>
      </View>
      <View ID="Windows.Server.Webservice.BasicWatcher.View.Perf.IIS.Web" Accessibility="Internal" Target="Windows.Server.Webservice.BasicWatcher.Computer.IIS" TypeID="SC!Microsoft.SystemCenter.PerformanceViewType" Visible="true">
        <Category>Operations</Category>
      </View>
      <View ID="Windows.Server.Webservice.BasicWatcher.View.Perf.ApacheTomcat" Accessibility="Internal" Target="Windows.Server.Webservice.BasicWatcher.Computer.ApacheTomcat" TypeID="SC!Microsoft.SystemCenter.PerformanceViewType" Visible="true">
        <Category>Operations</Category>
      </View>
      <View ID="Windows.Server.Webservice.BasicWatcher.View.Perf.Apache" Accessibility="Internal" Target="Windows.Server.Webservice.BasicWatcher.Computer.Apache" TypeID="SC!Microsoft.SystemCenter.PerformanceViewType" Visible="true">
        <Category>Operations</Category>
      </View>
    </Views>
    <Folders>
      <Folder ID="Windows.Server.Webservice.BasicWatcher.Folders" Accessibility="Internal" ParentFolder="SC!Microsoft.SystemCenter.Monitoring.ViewFolder.Root" />
      <Folder ID="Windows.Server.Webservice.BasicWatcher.Folders.HealthState" Accessibility="Internal" ParentFolder="Windows.Server.Webservice.BasicWatcher.Folders" />
      <Folder ID="Windows.Server.Webservice.BasicWatcher.Folders.Alerts" Accessibility="Internal" ParentFolder="Windows.Server.Webservice.BasicWatcher.Folders" />
      <Folder ID="Windows.Server.Webservice.BasicWatcher.Folders.Performance" Accessibility="Internal" ParentFolder="Windows.Server.Webservice.BasicWatcher.Folders" />
    </Folders>
    <FolderItems>
      <FolderItem ElementID="Windows.Server.Webservice.BasicWatcher.View.State.Webservice.Apache" Folder="Windows.Server.Webservice.BasicWatcher.Folders.HealthState" ID="Windows.Server.Webservice.BasicWatcher.View.State.Webservice.Apache.FolderItem" />
      <FolderItem ElementID="Windows.Server.Webservice.BasicWatcher.View.State.Webservice.ApacheTomcat" Folder="Windows.Server.Webservice.BasicWatcher.Folders.HealthState" ID="Windows.Server.Webservice.BasicWatcher.View.State.Webservice.ApacheTomcat.FolderItem" />
      <FolderItem ElementID="Windows.Server.Webservice.BasicWatcher.View.Alerts.FTP.IIS" Folder="Windows.Server.Webservice.BasicWatcher.Folders.Alerts" ID="Windows.Server.Webservice.BasicWatcher.View.Alerts.FTP.IIS.FolderItem" />
      <FolderItem ElementID="Windows.Server.Webservice.BasicWatcher.View.State.Webservice.IIS" Folder="Windows.Server.Webservice.BasicWatcher.Folders.HealthState" ID="Windows.Server.Webservice.BasicWatcher.View.State.Webservice.IIS.FolderItem" />
      <FolderItem ElementID="Windows.Server.Webservice.BasicWatcher.View.State.FTP.IIS" Folder="Windows.Server.Webservice.BasicWatcher.Folders.HealthState" ID="Windows.Server.Webservice.BasicWatcher.View.State.FTP.IIS.FolderItem" />
      <FolderItem ElementID="Windows.Server.Webservice.BasicWatcher.View.State.FTP.ServU" Folder="Windows.Server.Webservice.BasicWatcher.Folders.HealthState" ID="Windows.Server.Webservice.BasicWatcher.View.State.FTP.ServU.FolderItem" />
      <FolderItem ElementID="Windows.Server.Webservice.BasicWatcher.View.Alerts.FTP.ServU" Folder="Windows.Server.Webservice.BasicWatcher.Folders.Alerts" ID="Windows.Server.Webservice.BasicWatcher.View.Alerts.FTP.ServU.FolderItem" />
      <FolderItem ElementID="Windows.Server.Webservice.BasicWatcher.View.Alerts.WebService.IIS" Folder="Windows.Server.Webservice.BasicWatcher.Folders.Alerts" ID="Windows.Server.Webservice.BasicWatcher.View.Alerts.WebService.IIS.FolderItem" />
      <FolderItem ElementID="Windows.Server.Webservice.BasicWatcher.View.Alerts.WebService.ApacheTomcat" Folder="Windows.Server.Webservice.BasicWatcher.Folders.Alerts" ID="Windows.Server.Webservice.BasicWatcher.View.Alerts.WebService.ApacheTomcat.FolderItem" />
      <FolderItem ElementID="Windows.Server.Webservice.BasicWatcher.View.Alerts.WebService.Apache" Folder="Windows.Server.Webservice.BasicWatcher.Folders.Alerts" ID="Windows.Server.Webservice.BasicWatcher.View.Alerts.WebService.Apache.FolderItem" />
      <FolderItem ElementID="Windows.Server.Webservice.BasicWatcher.View.Perf.IIS.Web" Folder="Windows.Server.Webservice.BasicWatcher.Folders.Performance" ID="Windows.Server.Webservice.BasicWatcher.View.Perf.IIS.Web.FolderItem" />
      <FolderItem ElementID="Windows.Server.Webservice.BasicWatcher.View.Perf.ApacheTomcat" Folder="Windows.Server.Webservice.BasicWatcher.Folders.Performance" ID="Windows.Server.Webservice.BasicWatcher.View.Perf.ApacheTomcat.FolderItem" />
      <FolderItem ElementID="Windows.Server.Webservice.BasicWatcher.View.Perf.Apache" Folder="Windows.Server.Webservice.BasicWatcher.Folders.Performance" ID="Windows.Server.Webservice.BasicWatcher.View.Perf.Apache.FolderItem" />
    </FolderItems>
    <StringResources>
      <StringResource ID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.ApacheTomcat.AlertMessage" />
      <StringResource ID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.Apache.AlertMessage" />
      <StringResource ID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.FTP.ServU.AlertMessage" />
      <StringResource ID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.IIS.AlertMessage" />
      <StringResource ID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.FTP.IIS.AlertMessage" />
    </StringResources>
  </Presentation>
  <LanguagePacks>
    <LanguagePack ID="ENU" IsDefault="true">
      <DisplayStrings>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.ApacheTomcat">
          <Name>Monitor Apache Tomcat WebService</Name>
          <Description>Apache Tomcat Web Service</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.ApacheTomcat.AlertMessage">
          <Name>Apache Tomcat Web Service Down</Name>
          <Description>META INFORMATION:

Server Function: {0}

Server OU: {1}

Server Service Description: {2}



CHECK DETAILS:

Message: {3}

Result: {4}</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.ApacheTomcat" SubElementID="Error">
          <Name>Error</Name>
          <Description>Error</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.ApacheTomcat" SubElementID="Warning">
          <Name>Warning</Name>
          <Description>Warning</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.ApacheTomcat" SubElementID="Success">
          <Name>Success</Name>
          <Description>Success</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.Apache">
          <Name>Monitor Apache WebService</Name>
          <Description>Apache Web Service</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.Apache.AlertMessage">
          <Name>Apache Web Service Down</Name>
          <Description>META INFORMATION:

Server Function: {0}

Server OU: {1}

Server Service Description: {2}



CHECK DETAILS:

Message: {3}

Result: {4}</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.Apache" SubElementID="Error">
          <Name>Error</Name>
          <Description>Error</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.Apache" SubElementID="Warning">
          <Name>Warning</Name>
          <Description>Warning</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.Apache" SubElementID="Success">
          <Name>Success</Name>
          <Description>Success</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.FTP.ServU">
          <Name>Monitor Serv-U FTP</Name>
          <Description>FTP Serv-U Monitor</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.FTP.ServU.AlertMessage">
          <Name>Serv-U FTP Service Down</Name>
          <Description>META INFORMATION:

Server Function: {0}

Server OU: {1}

Server Service Description: {2}



CHECK DETAILS:

Message: {3}

Result: {4}</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.FTP.ServU" SubElementID="Error">
          <Name>Error</Name>
          <Description>Error</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.FTP.ServU" SubElementID="Warning">
          <Name>Warning</Name>
          <Description>Warning</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.FTP.ServU" SubElementID="Success">
          <Name>Success</Name>
          <Description>Success</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.IIS">
          <Name>Monitor IIS WebService</Name>
          <Description>IIS Web Service</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.IIS.AlertMessage">
          <Name>IIS Web Service Down</Name>
          <Description>META INFORMATION:

Server Function: {0}

Server OU: {1}

Server Service Description: {2}



CHECK DETAILS:

Message: {3}

Result: {4}</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.IIS" SubElementID="Error">
          <Name>Error</Name>
          <Description>Error</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.IIS" SubElementID="Warning">
          <Name>Warning</Name>
          <Description>Warning</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.IIS" SubElementID="Success">
          <Name>Success</Name>
          <Description>Success</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.FTP.IIS">
          <Name>Monitor IIS FTP</Name>
          <Description>Monitor IIS FTP Service</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.FTP.IIS.AlertMessage">
          <Name>IIS FTP Service Down</Name>
          <Description>META INFORMATION:

Server Function: {0}

Server OU: {1}

Server Service Description: {2}



CHECK DETAILS:

Message: {3}

Result: {4}</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.FTP.IIS" SubElementID="Error">
          <Name>Error</Name>
          <Description>Error</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.FTP.IIS" SubElementID="Warning">
          <Name>Warning</Name>
          <Description>Warning</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Monitor.WebService.FTP.IIS" SubElementID="Success">
          <Name>Success</Name>
          <Description>Success</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Perf.Apache.PercentProcessorTime">
          <Name>Collect Apache Percent Processor Time</Name>
          <Description>Description for the new rule</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Perf.ApacheTomcat.IODataMBPerSec">
          <Name>Collect ApacheTomcat IO Data MB Per Sec</Name>
          <Description>Description for the new rule</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Perf.ApacheTomcat.WorkingSetPrivateMB">
          <Name>Collect Apache Tomcat WorkingSet Private MB</Name>
          <Description>Description for the new rule</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Perf.ApacheTomcat.PercentProcessorTime">
          <Name>Collect ApacheTomcat Percent ProcessorTime</Name>
          <Description>Description for the new rule</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Perf.ApacheTomcat.HandleCount">
          <Name>Collect ApacheTomcat Handle Count</Name>
          <Description>Description for the new rule</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Perf.ApacheTomcat.IPConnections">
          <Name>Collect ApacheTomcat Unique IPConnections</Name>
          <Description>Description for the new rule</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Perf.Apache.WorkingSetPrivateMB">
          <Name>Collect Apache WorkingSetPrivate MB</Name>
          <Description>Description for the new rule</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Perf.Apache.IODataMBPerSec">
          <Name>Collect Apache IO Data MB Per Sec</Name>
          <Description>Description for the new rule</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Perf.IIS.Web.WorkingSetPrivateMB">
          <Name>Collect IIS Web WorkingSetPrivateMB</Name>
          <Description>Description for the new rule</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Perf.IIS.Web.IPConnections">
          <Name>Collect IIS Web Unique IPConnections</Name>
          <Description>Description for the new rule</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Perf.Apache.HandleCount">
          <Name>Collect Apache Handle Count</Name>
          <Description>Description for the new rule</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Perf.IIS.Web.IODataMBPerSec">
          <Name>Collect IIS Web IODataMBPerSec</Name>
          <Description>Description for the new rule</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Perf.IIS.Web.PercentProcessorTime">
          <Name>Collect IIS Web Percent ProcessorTime</Name>
          <Description>Description for the new rule</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Perf.IIS.Web.HandleCount">
          <Name>Collect IIS Web Handle Count</Name>
          <Description>Description for the new rule</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Perf.Apache.IPConnections">
          <Name>Collect Apache Unique IPConnections</Name>
          <Description>Description for the new rule</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Folders">
          <Name>Windows Server Webservice BasicWatcher</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Folders.HealthState">
          <Name>HealthState</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Folders.Alerts">
          <Name>Alerts</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Folders.Performance">
          <Name>Performance</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.View.State.Webservice.Apache">
          <Name>Web - Apache</Name>
          <Description>Description for the new view</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.View.State.Webservice.ApacheTomcat">
          <Name>Web - ApacheTomcat</Name>
          <Description>Description for the new view</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.View.Alerts.FTP.IIS">
          <Name>FTP - IIS</Name>
          <Description>Description for the new view</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.View.State.Webservice.IIS">
          <Name>Web - IIS</Name>
          <Description>Description for the new view</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.View.State.FTP.IIS">
          <Name>FTP - IIS</Name>
          <Description>Description for the new view</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.View.State.FTP.ServU">
          <Name>FTP - Serv-U </Name>
          <Description>Description for the new view</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.View.Alerts.FTP.ServU">
          <Name>FTP - Serv-U</Name>
          <Description>Description for the new view</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.View.Alerts.WebService.IIS">
          <Name>Web - IIS</Name>
          <Description>Description for the new view</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.View.Alerts.WebService.ApacheTomcat">
          <Name>Web - Apache Tomcat</Name>
          <Description>Description for the new view</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.View.Alerts.WebService.Apache">
          <Name>Web - Apache</Name>
          <Description>Description for the new view</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.View.Perf.IIS.Web">
          <Name>Web - IIS</Name>
          <Description>Description for the new view</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.View.Perf.ApacheTomcat">
          <Name>Web - ApacheTomcat</Name>
          <Description>Description for the new view</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.View.Perf.Apache">
          <Name>Web - Apache</Name>
          <Description>Description for the new view</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher">
          <Name>Windows Server Webservice BasicWatcher [Apache, Tomcat, IIS]</Name>
          <Description>Discovers Apache, Tomcat and IIS provides basic serivce monitor and more.</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Computer">
          <Name>Windows Server Webservice BasicWatcher Computer</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Computer" SubElementID="ComputerName">
          <Name>Computer</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Computer" SubElementID="Description">
          <Name>Description</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Computer" SubElementID="WindowsVersion">
          <Name>WindowsVersion</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Computer" SubElementID="IP">
          <Name>IP</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Computer" SubElementID="OU">
          <Name>OU</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Computer.IIS">
          <Name>Windows Server Webservice BasicWatcher Computer - IIS</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Computer.Apache">
          <Name>Windows Server Webservice BasicWatcher Computer - Apache</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Computer.ApacheTomcat">
          <Name>Windows Server Webservice BasicWatcher Computer - ApacheTomcat</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Computer.FTP.IIS">
          <Name>Windows Server Webservice BasicWatcher Computer - FTP IIS</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Computer.FTP.ServU">
          <Name>Windows Server Webservice BasicWatcher Computer - FTP ServU</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Discovery.Windows.Server.Webservice.Computer.FTP.ServU">
          <Name>Discovery Windows Server Webservice Computer FTP ServU</Name>
          <Description>Description for the new discovery.</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Discovery.Windows.Server.Webservice.Computer.ApacheTomcat">
          <Name>Discovery Windows Server Webservice Computer Apache Tomcat</Name>
          <Description>Description for the new discovery.</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Discovery.Windows.Server.Webservice.Computer.Apache">
          <Name>Discovery Windows Server Webservice Computer Apache</Name>
          <Description>Description for the new discovery.</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Discovery.Windows.Server.Webservice.Computer.IIS">
          <Name>Discovery Windows Server Webservice Computer IIS</Name>
          <Description>Description for the new discovery.</Description>
        </DisplayString>
        <DisplayString ElementID="Windows.Server.Webservice.BasicWatcher.Discovery.Windows.Server.Webservice.Computer.FTP.IIS">
          <Name>Discovery Windows Server Webservice Computer FTP IIS</Name>
          <Description>Description for the new discovery.</Description>
        </DisplayString>
      </DisplayStrings>
      <KnowledgeArticles></KnowledgeArticles>
    </LanguagePack>
  </LanguagePacks>
</ManagementPack>